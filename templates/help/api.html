{% extends "_layouts/default.html" %}
{% import "_helpers/_card.html" as card_helpers %}

{% block content %}
<div class="card">
    {{ card_helpers.render_title('{} API'.format(brand)) }}
    <div class="card-block pt-0">
    <p>
        {{brand}} has a <a href="http://en.wikipedia.org/wiki/Representational_state_transfer">RESTful API</a>
        that can be used for getting information about tasks, submitting contributions, etc.
        The API end point is available at:
    </p>
    <pre>
        <code data-language="http">{{url_for('api.index', _external=True)}}</code>
    </pre>
    <p>
        The API expects and returns JSON.
    </p>
    <p>
        Some requests will need an API key to authenticate and authorize the operation. You can find your API key
        listed in your profile.
    </p>
    <p>
        The returned objects will have a links and link fields, not included in the model in order to support 
        <a href="https://en.wikipedia.org/wiki/HATEOAS">Hypermedia as the Engine of Application State</a> (also known as HATEOAS), 
        to show the relationships between objects.
    </p>
    <p>
        All objects will return a <strong>link</strong> field which will be the absolute URL for that specific object within the API. If the object has any parents, 
        you will find the relations in the links list. For example, for a Task Run you will get something like this:
    </p>
    <pre>
        <code data-mode="javascript" data-readOnly="true" data-theme="lesser-dark">
    {
        "info": 65,
        "user_id": null,
        "links": [
            "<link rel='parent' title='project' href='http://localhost:5000/api/project/90'/>",
            "<link rel='parent' title='task' href='http://localhost:5000/api/task/5894'/>"
        ],
        "task_id": 5894,
        "created": "2012-07-07T17:23:45.714184",
        "finish_time": "2012-07-07T17:23:45.714210",
        "calibration": null,
        "project_id": 90,
        "user_ip": "X.X.X.X",
        "link": "<link rel='self' title='taskrun' href='http://localhost:5000/api/taskrun/8969'/>",
        "timeout": null,
        "id": 8969
    }
        </code>
    </pre>

                <h2>Projects API end point</h2>
                <p>To get a list of available projects:</p>
                <ul>
                    <li><a href="{{url_for('api.api_project')}}">{{url_for('api.api_project', _external=True)}}</a></li>
                </ul>
                <p>To search for a specific project:</p>
                <ul>
                    <li><a href="{{url_for('api.api_project', short_name='pinyincardcatalogue')}}">{{url_for('api.api_project', short_name='pinyincardcatalogue', _external=True)}}</a></li>
                </ul>
                <hr>

                <h2>Tasks API end point</h2>
                <p>To get a list of available tasks:</p>
                <ul>
                    <li><a href="{{url_for('api.api_task')}}">{{url_for('api.api_task', _external=True)}}</a></li>
                </ul>
                <p>To get the tasks for a given project:</p>
                <ul>
                    <li><a href="{{url_for('api.api_task', project_id=project_id)}}">{{url_for('api.api_task', project_id=project_id, _external=True)}}</a></li>
                </ul>
                <p>Or, to get a list of completed tasks for a given project:</p>
                <ul>
                    <li><a href="{{url_for('api.api_task', project_id=project_id, state='completed')}}">{{url_for('api.api_task', project_id=project_id,  state='completed', _external=True)}}</a></li>
                </ul>
                <hr>

                <h2>Task Runs API end point</h2>
                <p>To get a list of contributions:
                </p>
                <ul>
                    <li><a href="{{url_for('api.api_taskrun')}}">{{url_for('api.api_taskrun', _external=True)}}</a></li>
                </ul>
                <p>To get the contributions for a given project:</p>
                <ul>
                    <li><a href="{{url_for('api.api_taskrun', project_id=project_id)}}">{{url_for('api.api_taskrun', project_id=project_id, _external=True)}}</a></li>
                </ul>
                <hr>
                <p>
                    <strong>Note: </strong>GET actions are limited to only 20 items by default,
                    you can use <em>limit</em> and <em>offset</em> to tune the number of results.
                    For further information read the <a href="http://docs.pybossa.com/en/latest/api.html">documentation</a>.
                </p>
                <p>
                    For more information about the API please, see the <a href="http://docs.pybossa.com/en/latest/api.html">PyBossa documentation</a> and the <a href="http://docs.pybossa.com/en/latest/user/tutorial.html">step by step tutorial</a>.
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
